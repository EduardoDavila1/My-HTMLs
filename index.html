<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Ed Studios | Universe Hub</title>
    <style>
        :root {
            --neon-blue: #00f3ff;
            --glass-bg: rgba(0, 0, 0, 0.7);
            --glass-border: 1px solid rgba(0, 243, 255, 0.3);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            overflow: hidden;
            background-color: #000;
            font-family: 'Courier New', Courier, monospace;
            color: white;
            touch-action: none; /* Evita zoom y scroll en móviles */
        }

        /* Lienzo 3D */
        #canvas-container {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: 1;
        }

        /* --- PANTALLA DE PERMISO (INTRO) --- */
        #intro-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: black;
            z-index: 999;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: opacity 0.8s ease;
        }

        #start-btn {
            padding: 15px 30px;
            border: 2px solid var(--neon-blue);
            background: transparent;
            color: var(--neon-blue);
            font-size: 1.2rem;
            font-family: inherit;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 2px;
            box-shadow: 0 0 15px var(--neon-blue);
            border-radius: 5px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 10px var(--neon-blue); }
            50% { box-shadow: 0 0 25px var(--neon-blue), inset 0 0 5px var(--neon-blue); }
            100% { box-shadow: 0 0 10px var(--neon-blue); }
        }

        /* --- BOTÓN MENÚ (Móvil) --- */
        #menu-toggle {
            position: fixed;
            top: 20px; right: 20px;
            z-index: 100;
            background: var(--glass-bg);
            border: var(--glass-border);
            color: var(--neon-blue);
            width: 45px; height: 45px;
            display: none; /* Oculto en PC */
            justify-content: center;
            align-items: center;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.5rem;
            backdrop-filter: blur(5px);
        }

        /* --- HUD (Enlaces) --- */
        #hud {
            position: fixed;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            z-index: 10;
            text-align: center;
            width: 100%;
            max-width: 500px;
            pointer-events: none; /* Dejar pasar clics a las estrellas si no hay botones */
        }

        .project-btn {
            pointer-events: auto; /* Reactivar clics en los botones */
            display: block;
            margin: 15px auto;
            padding: 15px 0;
            width: 80%;
            background: rgba(10, 10, 10, 0.6);
            border: 1px solid #333;
            color: #fff;
            text-decoration: none;
            font-size: 1.1rem;
            letter-spacing: 2px;
            text-transform: uppercase;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(4px);
        }

        .project-btn:hover {
            border-color: var(--neon-blue);
            box-shadow: 0 0 15px rgba(0, 243, 255, 0.3);
            background: rgba(0, 243, 255, 0.1);
            transform: scale(1.02);
        }

        /* --- ESTILOS MÓVILES --- */
        @media (max-width: 768px) {
            #menu-toggle { display: flex; } /* Mostrar botón menú */
            
            #hud {
                top: 0; left: 0;
                transform: none;
                width: 100%; height: 100%;
                max-width: none;
                background: rgba(0,0,0,0.9);
                display: flex;
                flex-direction: column;
                justify-content: center;
                opacity: 0; /* Invisible por defecto */
                transition: opacity 0.4s ease;
                pointer-events: none;
            }

            #hud.active {
                opacity: 1;
                pointer-events: all;
            }
        }
    </style>
</head>
<body>

    <div id="intro-overlay">
        <button id="start-btn">INICIAR SISTEMA</button>
        <p style="margin-top:15px; color:#888; font-size:0.8rem;">Habilita el acceso a sensores</p>
    </div>

    <div id="menu-toggle">☰</div>

    <div id="canvas-container"></div>

    <nav id="hud">
        <a href="gaia/index.html" class="project-btn">Gaia Universe</a>
        <a href="Antena.html" class="project-btn">Proyecto Antena</a>
        <a href="SharkTank.html" class="project-btn">Shark Tank</a>
        <a href="cv.pdf" class="project-btn">Expediente (CV)</a>
    </nav>

    <script type="module">
        import * as THREE from 'https://unpkg.com/three@0.160.0/build/three.module.js';

        let scene, camera, renderer, stars;
        let mouseX = 0, mouseY = 0;
        let targetX = 0, targetY = 0;
        let isMobile = false;

        // Variables para giroscopio
        let gyroX = 0, gyroY = 0;

        const container = document.getElementById('canvas-container');
        const introOverlay = document.getElementById('intro-overlay');
        const startBtn = document.getElementById('start-btn');

        // --- 1. CONFIGURACIÓN THREE.JS ---
        function init() {
            scene = new THREE.Scene();
            scene.fog = new THREE.FogExp2(0x000000, 0.001);

            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 10;

            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
            container.appendChild(renderer.domElement);

            // Crear Estrellas
            const geometry = new THREE.BufferGeometry();
            const count = 7000;
            const positions = new Float32Array(count * 3);

            for(let i = 0; i < count * 3; i++) {
                positions[i] = (Math.random() - 0.5) * 1500;
            }

            geometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
            const material = new THREE.PointsMaterial({
                size: 2,
                color: 0xffffff,
                transparent: true,
                opacity: 0.8,
                sizeAttenuation: true
            });

            stars = new THREE.Points(geometry, material);
            scene.add(stars);

            // Listeners
            window.addEventListener('resize', onResize);
            document.addEventListener('mousemove', onMouseMove);
        }

        function onResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        function onMouseMove(e) {
            if(!isMobile) {
                mouseX = (e.clientX - window.innerWidth / 2) * 0.05;
                mouseY = (e.clientY - window.innerHeight / 2) * 0.05;
            }
        }

        // --- 2. LÓGICA DE GIROSCOPIO ---
        function handleOrientation(event) {
            isMobile = true;
            
            // Limitamos los valores para que no salte
            // Beta: Arriba/Abajo (-180 a 180)
            // Gamma: Izquierda/Derecha (-90 a 90)
            
            const beta = event.beta || 0;
            const gamma = event.gamma || 0;

            // Sensibilidad
            gyroX = gamma * 2; 
            gyroY = (beta - 45) * 2; // -45 para centrar la vista al sostener el cel
        }

        // --- 3. ANIMACIÓN ---
        function animate() {
            requestAnimationFrame(animate);

            // Rotación constante suave
            stars.rotation.y += 0.0003;

            if (isMobile) {
                // Movimiento con Giroscopio (Lerp para suavidad)
                targetX += (gyroX - targetX) * 0.05;
                targetY += (gyroY - targetY) * 0.05;
            } else {
                // Movimiento con Mouse
                targetX += (mouseX - targetX) * 0.05;
                targetY += (mouseY - targetY) * 0.05;
            }

            // Aplicar movimiento a la cámara (Efecto Parallax)
            camera.position.x = targetX * 0.1;
            camera.position.y = -targetY * 0.1;
            camera.lookAt(scene.position);

            renderer.render(scene, camera);
        }

        // --- 4. GESTIÓN DE PERMISOS E INICIO ---
        
        // Función principal de arranque
        async function startExperience() {
            // Ocultar Intro
            introOverlay.style.opacity = '0';
            setTimeout(() => introOverlay.style.display = 'none', 800);

            // Iniciar Three.js
            init();
            animate();

            // PEDIR PERMISO (Clave para iOS 13+)
            if (typeof DeviceOrientationEvent !== 'undefined' && 
                typeof DeviceOrientationEvent.requestPermission === 'function') {
                try {
                    const permission = await DeviceOrientationEvent.requestPermission();
                    if (permission === 'granted') {
                        window.addEventListener('deviceorientation', handleOrientation);
                    } else {
                        alert("Permiso de sensores denegado. Toca recargar si cambias de opinión.");
                    }
                } catch (e) {
                    console.error(e);
                }
            } else {
                // Android y PC
                window.addEventListener('deviceorientation', handleOrientation);
            }
        }

        // Evento Click en botón INICIAR
        startBtn.addEventListener('click', startExperience);

        // --- 5. MENÚ HAMBURGUESA ---
        const menuToggle = document.getElementById('menu-toggle');
        const hud = document.getElementById('hud');
        let menuOpen = false;

        menuToggle.addEventListener('click', () => {
            menuOpen = !menuOpen;
            if(menuOpen) {
                hud.classList.add('active');
                menuToggle.innerHTML = '✕';
            } else {
                hud.classList.remove('active');
                menuToggle.innerHTML = '☰';
            }
        });

    </script>
</body>
    </html>
    
